define ("mod_kalvidres/kalvidres_mod_form",["exports","jquery","core/notification","core/pubsub","core/str","core/modal_factory","local_kaltura/modal_video_picker","local_kaltura/modal_video_picker_events","local_kaltura/modal_kaltura_upload","local_kaltura/kaltura_events","local_kaltura/kaltura_ajax"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=l(b);c=l(c);f=l(f);g=l(g);h=l(h);i=l(i);j=l(j);k=l(k);function l(a){return a&&a.__esModule?a:{default:a}}function m(a,b){return p(a)||o(a,b)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function p(a){if(Array.isArray(a))return a}function q(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function r(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){q(h,d,e,f,g,"next",a)}function g(a){q(h,d,e,f,g,"throw",a)}f(void 0)})}}var s={OPEN_VIDEO_PICKER:"#id_add_media",OPEN_UPLOAD_MODAL:"[data-action=\"upload\"]",ENTRY_ID:"#entry_id",VIDEO_TITLE:"#video_title",ENTRY_THUMBNAIL:"#media_thumbnail",SELECTED_ENTRY_HEADER:"[data-region=\"selected-entry-header\"]"},t=function(){var a=r(regeneratorRuntime.mark(function a(b,d,e,h){var j,k,l,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.prev=0;a.next=3;return Promise.all([f.default.create({type:g.default.getType()}),f.default.create({type:i.default.getType()})]);case 3:j=a.sent;k=m(j,2);l=k[0];n=k[1];l.contextid=b;l.selectedEntryId=d;l.selectedEntryName=e;l.selectedEntryThumbnail=h;n.contextid=b;u(l,n,b);a.next=18;break;case 15:a.prev=15;a.t0=a["catch"](0);c.default.exception(a.t0);case 18:case"end":return a.stop();}}},a,null,[[0,15]])}));return function(){return a.apply(this,arguments)}}();a.init=t;var u=function(a,c,f){(0,b.default)(s.OPEN_VIDEO_PICKER).on("click",function(){a.show()});(0,b.default)(s.OPEN_UPLOAD_MODAL).on("click",function(a){a.preventDefault();var d=(0,b.default)(a.currentTarget).attr("data-upload-type");c.renderUploadForm(d);c.show()});(0,d.subscribe)(h.default.entrySelected,function(){var a=r(regeneratorRuntime.mark(function a(c){var d;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:(0,b.default)(s.ENTRY_ID).val(c.entryId);(0,b.default)(s.ENTRY_THUMBNAIL).attr("src",c.entryThumbnail);(0,b.default)(s.VIDEO_TITLE).val(c.entryName);a.next=5;return(0,e.get_string)("selected_entry","local_kaltura",c.entryName);case 5:d=a.sent;(0,b.default)(s.SELECTED_ENTRY_HEADER).text(d);case 7:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}());(0,d.subscribe)(j.default.uploadComplete,function(){var a=r(regeneratorRuntime.mark(function a(d){var g,h;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c.hide();a.next=3;return k.default.getEntry(f,d);case 3:g=a.sent;(0,b.default)(s.ENTRY_ID).val(g.id);(0,b.default)(s.ENTRY_THUMBNAIL).attr("src",g.thumbnailUrl);(0,b.default)(s.VIDEO_TITLE).val(g.name);a.next=9;return(0,e.get_string)("selected_entry","local_kaltura",g.name);case 9:h=a.sent;(0,b.default)(s.SELECTED_ENTRY_HEADER).text(h);case 11:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}())}});
//# sourceMappingURL=kalvidres_mod_form.min.js.map
